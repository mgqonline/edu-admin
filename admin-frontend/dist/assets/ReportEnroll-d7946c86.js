import{n as l}from"./index-67337038.js";const r={name:"ReportEnroll",data(){return{range:"month",loadingNew:!1,loadingShare:!1,points:[],channelShare:[]}},computed:{columnsNew(){return[{title:this.range==="day"?"日期":this.range==="week"?"周":"月份",dataIndex:this.range==="day"?"date":this.range==="week"?"week":"month",key:"key"},{title:"新增报名数",dataIndex:"count",key:"count"}]},columnsShare(){return[{title:"渠道",dataIndex:"channel",key:"channel"},{title:"人数",dataIndex:"count",key:"count"},{title:"占比(%)",dataIndex:"ratio",key:"ratio"}]}},methods:{async loadEnrollNew(){this.loadingNew=!0;try{const a=await(await fetch(`/api/report/enroll/new?range=${this.range}`)).json(),e=a&&a.code===200?a.data&&a.data.points||[]:[];this.points=e.map((n,o)=>({...n,_key:o}))}finally{this.loadingNew=!1}},async loadChannelShare(){this.loadingShare=!0;try{const a=await(await fetch("/api/report/enroll/channel-share")).json();this.channelShare=a&&a.code===200?a.data||[]:[]}finally{this.loadingShare=!1}},async exportEnrollNew(){const t=`/api/report/export/enroll-new.csv?range=${this.range}`;window.open(t,"_blank")},async exportChannelShare(){const t="/api/report/export/channel-share.csv";window.open(t,"_blank")}},mounted(){this.loadEnrollNew(),this.loadChannelShare()}};var s=function(){var a=this,e=a._self._c;return e("div",{staticStyle:{background:"#fff",padding:"16px"}},[e("h2",[a._v("招生报表")]),e("a-space",{staticStyle:{"margin-bottom":"12px"}},[e("a-select",{staticStyle:{width:"150px"},model:{value:a.range,callback:function(n){a.range=n},expression:"range"}},[e("a-select-option",{attrs:{value:"day"}},[a._v("最近14天")]),e("a-select-option",{attrs:{value:"week"}},[a._v("最近8周")]),e("a-select-option",{attrs:{value:"month"}},[a._v("最近6个月")])],1),e("a-button",{attrs:{type:"primary",loading:a.loadingNew},on:{click:a.loadEnrollNew}},[a._v("加载趋势")]),e("a-button",{attrs:{disabled:a.loadingNew},on:{click:a.exportEnrollNew}},[a._v("导出趋势CSV")])],1),e("a-table",{attrs:{"data-source":a.points,columns:a.columnsNew,pagination:!1,rowKey:"_key"}}),e("h3",{staticStyle:{"margin-top":"24px"}},[a._v("渠道占比")]),e("a-space",{staticStyle:{"margin-bottom":"8px"}},[e("a-button",{attrs:{type:"primary",loading:a.loadingShare},on:{click:a.loadChannelShare}},[a._v("加载渠道占比")]),e("a-button",{attrs:{disabled:a.loadingShare},on:{click:a.exportChannelShare}},[a._v("导出渠道占比CSV")])],1),e("a-table",{attrs:{"data-source":a.channelShare,columns:a.columnsShare,pagination:!1,rowKey:"channel"}})],1)},i=[],c=l(r,s,i,!1,null,"bc0b881c",null,null);const h=c.exports;export{h as default};
