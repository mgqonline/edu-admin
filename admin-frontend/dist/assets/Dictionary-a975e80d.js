import{n as i}from"./index-67337038.js";const n={name:"DictionaryPage",data(){return{loading:!1,dicts:{courseCategory:[],classType:[],studentStatus:[],commonStatus:[]},itemModal:{visible:!1,type:"",form:{id:"",code:"",name:"",sortOrder:0,status:"enabled"},submitting:!1}}},created(){this.loadDicts()},methods:{async loadDicts(){this.loading=!0;try{const t=await(await fetch("/api/base/dict/all")).json();if(t&&t.code===200){const e=t.data||{};this.dicts.courseCategory=e.courseCategory||e.courseCategories||[],this.dicts.classType=e.classType||e.classTypes||[],this.dicts.studentStatus=e.studentStatus||[],this.dicts.commonStatus=e.commonStatus||[],this.$message&&this.$message.success("字典数据已加载")}else this.useFallback(),this.$message&&this.$message.warning("字典接口不可用，使用本地数据")}catch{this.useFallback(),this.$message&&this.$message.error("字典数据加载失败，使用本地数据")}finally{this.loading=!1}},useFallback(){this.dicts={courseCategory:[{id:"c1",code:"math",name:"数学"},{id:"c2",code:"eng",name:"英语"}],classType:[{id:"t1",code:"1v1",name:"一对一"},{id:"t2",code:"small",name:"小班"}],studentStatus:[{id:"s1",code:"studying",name:"在读"},{id:"s2",code:"quit",name:"退学"}],commonStatus:[{id:"cs1",code:"enabled",name:"启用"},{id:"cs2",code:"disabled",name:"停用"}]}},openAdd(a){this.itemModal.visible=!0,this.itemModal.type=a,this.itemModal.form={id:"",code:"",name:"",sortOrder:0,status:"enabled"}},openEdit(a,t){this.itemModal.visible=!0,this.itemModal.type=a,this.itemModal.form={id:t.id,code:t.code,name:t.name,sortOrder:t.sortOrder||0,status:t.status||"enabled"}},async onDelete(a){if(a.id)try{const e=await(await fetch(`/api/base/dict/delete/${a.id}`,{method:"DELETE"})).json();e&&e.code===200?(this.$message&&this.$message.success("删除成功"),this.loadDicts()):this.$message&&this.$message.error(e.message||"删除失败")}catch{this.$message&&this.$message.error("删除失败")}},async saveItem(){this.itemModal.submitting=!0;const a={...this.itemModal.form,type:this.itemModal.type};try{const t=a.id?`/api/base/dict/update/${a.id}`:"/api/base/dict/save",e=a.id?"PUT":"POST",o=await(await fetch(t,{method:e,headers:{"Content-Type":"application/json"},body:JSON.stringify(a)})).json();o&&o.code===200?(this.$message&&this.$message.success("保存成功"),this.itemModal.visible=!1,this.loadDicts()):this.$message&&this.$message.error(o.message||"保存失败")}catch{this.$message&&this.$message.error("保存失败")}finally{this.itemModal.submitting=!1}}}};var r=function(){var t=this,e=t._self._c;return e("div",{staticClass:"dict-page"},[e("a-page-header",{attrs:{title:"字典配置","sub-title":"课程分类、班级类型、学员状态、通用状态"}}),e("a-space",{staticStyle:{width:"100%"},attrs:{direction:"vertical"}},[e("a-space",[e("a-button",{attrs:{type:"primary",loading:t.loading},on:{click:t.loadDicts}},[t._v("刷新")])],1),e("a-row",{attrs:{gutter:16}},[e("a-col",{attrs:{span:12}},[e("a-card",{attrs:{title:"课程分类",bordered:""}},[e("a-space",{attrs:{size:8,wrap:""}},[t._l(t.dicts.courseCategory,function(s){return e("a-tag",{key:s.id,attrs:{closable:!0},on:{close:function(o){return t.onDelete(s)},click:function(o){return t.openEdit("courseCategory",s)}}},[t._v(t._s(s.name))])}),e("a-button",{attrs:{size:"small",type:"dashed"},on:{click:function(s){return t.openAdd("courseCategory")}}},[t._v("新增")])],2)],1)],1),e("a-col",{attrs:{span:12}},[e("a-card",{attrs:{title:"班级类型",bordered:""}},[e("a-space",{attrs:{size:8,wrap:""}},[t._l(t.dicts.classType,function(s){return e("a-tag",{key:s.id,attrs:{closable:!0},on:{close:function(o){return t.onDelete(s)},click:function(o){return t.openEdit("classType",s)}}},[t._v(t._s(s.name))])}),e("a-button",{attrs:{size:"small",type:"dashed"},on:{click:function(s){return t.openAdd("classType")}}},[t._v("新增")])],2)],1)],1)],1),e("a-row",{attrs:{gutter:16}},[e("a-col",{attrs:{span:12}},[e("a-card",{attrs:{title:"学员状态",bordered:""}},[e("a-space",{attrs:{size:8,wrap:""}},[t._l(t.dicts.studentStatus,function(s){return e("a-tag",{key:s.id,attrs:{closable:!0},on:{close:function(o){return t.onDelete(s)},click:function(o){return t.openEdit("studentStatus",s)}}},[t._v(t._s(s.name))])}),e("a-button",{attrs:{size:"small",type:"dashed"},on:{click:function(s){return t.openAdd("studentStatus")}}},[t._v("新增")])],2)],1)],1),e("a-col",{attrs:{span:12}},[e("a-card",{attrs:{title:"通用状态",bordered:""}},[e("a-space",{attrs:{size:8,wrap:""}},[t._l(t.dicts.commonStatus,function(s){return e("a-tag",{key:s.id,attrs:{closable:!0},on:{close:function(o){return t.onDelete(s)},click:function(o){return t.openEdit("commonStatus",s)}}},[t._v(t._s(s.name))])}),e("a-button",{attrs:{size:"small",type:"dashed"},on:{click:function(s){return t.openAdd("commonStatus")}}},[t._v("新增")])],2)],1)],1)],1),e("a-modal",{attrs:{visible:t.itemModal.visible,title:"字典项",confirmLoading:t.itemModal.submitting},on:{ok:t.saveItem,cancel:function(s){t.itemModal.visible=!1}}},[e("a-form",{attrs:{layout:"vertical"}},[e("a-form-item",{attrs:{label:"编码"}},[e("a-input",{model:{value:t.itemModal.form.code,callback:function(s){t.$set(t.itemModal.form,"code",s)},expression:"itemModal.form.code"}})],1),e("a-form-item",{attrs:{label:"名称"}},[e("a-input",{model:{value:t.itemModal.form.name,callback:function(s){t.$set(t.itemModal.form,"name",s)},expression:"itemModal.form.name"}})],1),e("a-form-item",{attrs:{label:"排序"}},[e("a-input",{attrs:{type:"number"},model:{value:t.itemModal.form.sortOrder,callback:function(s){t.$set(t.itemModal.form,"sortOrder",s)},expression:"itemModal.form.sortOrder"}})],1),e("a-form-item",{attrs:{label:"状态"}},[e("a-select",{model:{value:t.itemModal.form.status,callback:function(s){t.$set(t.itemModal.form,"status",s)},expression:"itemModal.form.status"}},[e("a-select-option",{attrs:{value:"enabled"}},[t._v("启用")]),e("a-select-option",{attrs:{value:"disabled"}},[t._v("禁用")])],1)],1)],1)],1)],1)],1)},c=[],l=i(n,r,c,!1,null,null,null,null);const u=l.exports;export{u as default};
