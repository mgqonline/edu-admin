import{n as r,_ as n}from"./index-67337038.js";const o={name:"StudentChangeManage",components:{CompatDatePicker:()=>n(()=>import("./CompatDatePicker-77afd840.js"),["assets/CompatDatePicker-77afd840.js","assets/index-67337038.js","assets/index-f5f188af.css","assets/ReportEnroll-e3b0c442.css"])},data(){return{routeSid:null,transfer:{studentId:null,fromClassId:null,toClassId:null,reason:""},approve:{id:null,approverFrom:null,approverTo:null},transferList:[],suspend:{studentId:null,reason:"",resumeDate:null},suspendList:[],withdraw:{studentId:null,reason:""},withdrawList:[],transferColumns:[{title:"ID",dataIndex:"id",key:"id"},{title:"学员ID",dataIndex:"studentId",key:"studentId"},{title:"原班级",dataIndex:"fromClassId",key:"fromClassId"},{title:"新班级",dataIndex:"toClassId",key:"toClassId"},{title:"状态",dataIndex:"status",key:"status"},{title:"备注",dataIndex:"remark",key:"remark"}],suspendColumns:[{title:"ID",dataIndex:"id",key:"id"},{title:"学员ID",dataIndex:"studentId",key:"studentId"},{title:"类型",dataIndex:"type",key:"type"},{title:"原因",dataIndex:"reason",key:"reason"},{title:"预计复学",dataIndex:"resumeDate",key:"resumeDate"},{title:"状态",dataIndex:"status",key:"status"}],withdrawColumns:[{title:"ID",dataIndex:"id",key:"id"},{title:"学员ID",dataIndex:"studentId",key:"studentId"},{title:"退费金额",dataIndex:"refundAmount",key:"refundAmount"},{title:"状态",dataIndex:"status",key:"status"},{title:"原因",dataIndex:"reason",key:"reason"}]}},methods:{async applyTransfer(){const a=await(await fetch("/api/student/change/transfer/apply",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify(this.transfer)})).json();a.code===200?(this.$message.success("申请成功"),this.loadTransferList()):this.$message.error(a.msg||"失败")},async approveTransfer(){const a=await(await fetch("/api/student/change/transfer/approve",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify(this.approve)})).json();a.code===200?(this.$message.success("审批通过"),this.loadTransferList()):this.$message.error(a.msg||"失败")},async loadTransferList(){let t=(await(await fetch("/api/student/change/transfer/list")).json()).data||[];this.routeSid&&(t=t.filter(e=>Number(e.studentId)===this.routeSid)),this.transferList=t},async applySuspend(){const s={...this.suspend,resumeDate:this.suspend.resumeDate?this.suspend.resumeDate.format("YYYY-MM-DD"):null},t=await(await fetch("/api/student/change/suspend/apply",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify(s)})).json();t.code===200?(this.$message.success("休学登记成功"),this.loadSuspendList()):this.$message.error(t.msg||"失败")},async applyResume(){const a=await(await fetch("/api/student/change/resume/apply",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({studentId:this.suspend.studentId})})).json();a.code===200?(this.$message.success("复学成功"),this.loadSuspendList()):this.$message.error(a.msg||"失败")},async loadSuspendList(){let t=(await(await fetch("/api/student/change/suspend/list")).json()).data||[];this.routeSid&&(t=t.filter(e=>Number(e.studentId)===this.routeSid)),this.suspendList=t},async applyWithdraw(){const a=await(await fetch("/api/student/change/withdraw/apply",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify(this.withdraw)})).json();a.code===200?(this.$message.success("退学发起成功"),this.loadWithdrawList()):this.$message.error(a.msg||"失败")},async loadWithdrawList(){let t=(await(await fetch("/api/student/change/withdraw/list")).json()).data||[];this.routeSid&&(t=t.filter(e=>Number(e.studentId)===this.routeSid)),this.withdrawList=t}},created(){try{const s=this.$route&&this.$route.query?this.$route.query:{};if(s&&s.studentId){const a=Number(s.studentId)||null;this.routeSid=a,this.transfer.studentId=a,this.suspend.studentId=a,this.withdraw.studentId=a}}catch{}this.loadTransferList(),this.loadSuspendList(),this.loadWithdrawList()}};var i=function(){var a=this,t=a._self._c;return t("div",{staticClass:"student-change"},[t("a-page-header",{attrs:{title:"学员异动管理","sub-title":"调班 / 休学 / 复学 / 退学"}}),t("a-card",{staticStyle:{"margin-bottom":"12px"},attrs:{bordered:"",title:"调班申请与审批"}},[t("a-form",{attrs:{"label-col":{span:6},"wrapper-col":{span:16}}},[t("a-row",{attrs:{gutter:16}},[t("a-col",{attrs:{span:6}},[t("a-form-item",{attrs:{label:"学员ID"}},[t("a-input-number",{staticStyle:{width:"100%"},attrs:{min:1},model:{value:a.transfer.studentId,callback:function(e){a.$set(a.transfer,"studentId",e)},expression:"transfer.studentId"}})],1)],1),t("a-col",{attrs:{span:6}},[t("a-form-item",{attrs:{label:"原班级ID"}},[t("a-input-number",{staticStyle:{width:"100%"},attrs:{min:1},model:{value:a.transfer.fromClassId,callback:function(e){a.$set(a.transfer,"fromClassId",e)},expression:"transfer.fromClassId"}})],1)],1),t("a-col",{attrs:{span:6}},[t("a-form-item",{attrs:{label:"新班级ID"}},[t("a-input-number",{staticStyle:{width:"100%"},attrs:{min:1},model:{value:a.transfer.toClassId,callback:function(e){a.$set(a.transfer,"toClassId",e)},expression:"transfer.toClassId"}})],1)],1),t("a-col",{attrs:{span:6}},[t("a-form-item",{attrs:{label:"备注"}},[t("a-input",{model:{value:a.transfer.reason,callback:function(e){a.$set(a.transfer,"reason",e)},expression:"transfer.reason"}})],1)],1)],1),t("a-form-item",{attrs:{"wrapper-col":{span:16,offset:6}}},[t("a-space",[t("a-button",{attrs:{type:"primary"},on:{click:a.applyTransfer}},[a._v("发起申请")]),t("a-button",{on:{click:a.loadTransferList}},[a._v("加载列表")])],1)],1)],1),t("a-divider"),t("a-form",{staticStyle:{"margin-top":"12px"},attrs:{"label-col":{span:6},"wrapper-col":{span:16}}},[t("a-row",{attrs:{gutter:16}},[t("a-col",{attrs:{span:6}},[t("a-form-item",{attrs:{label:"审批记录ID"}},[t("a-input-number",{staticStyle:{width:"100%"},attrs:{min:1},model:{value:a.approve.id,callback:function(e){a.$set(a.approve,"id",e)},expression:"approve.id"}})],1)],1),t("a-col",{attrs:{span:6}},[t("a-form-item",{attrs:{label:"原班教师ID"}},[t("a-input-number",{staticStyle:{width:"100%"},attrs:{min:1},model:{value:a.approve.approverFrom,callback:function(e){a.$set(a.approve,"approverFrom",e)},expression:"approve.approverFrom"}})],1)],1),t("a-col",{attrs:{span:6}},[t("a-form-item",{attrs:{label:"新班教师ID"}},[t("a-input-number",{staticStyle:{width:"100%"},attrs:{min:1},model:{value:a.approve.approverTo,callback:function(e){a.$set(a.approve,"approverTo",e)},expression:"approve.approverTo"}})],1)],1)],1),t("a-form-item",{attrs:{"wrapper-col":{span:16,offset:6}}},[t("a-space",[t("a-button",{attrs:{type:"primary"},on:{click:a.approveTransfer}},[a._v("审批通过")])],1)],1)],1),t("a-table",{attrs:{"data-source":a.transferList,columns:a.transferColumns,rowKey:"id",pagination:!1}})],1),t("a-card",{staticStyle:{"margin-bottom":"12px"},attrs:{bordered:"",title:"休学 / 复学"}},[t("a-form",{attrs:{"label-col":{span:6},"wrapper-col":{span:16}}},[t("a-row",{attrs:{gutter:16}},[t("a-col",{attrs:{span:6}},[t("a-form-item",{attrs:{label:"学员ID"}},[t("a-input-number",{staticStyle:{width:"100%"},attrs:{min:1},model:{value:a.suspend.studentId,callback:function(e){a.$set(a.suspend,"studentId",e)},expression:"suspend.studentId"}})],1)],1),t("a-col",{attrs:{span:6}},[t("a-form-item",{attrs:{label:"原因"}},[t("a-input",{model:{value:a.suspend.reason,callback:function(e){a.$set(a.suspend,"reason",e)},expression:"suspend.reason"}})],1)],1),t("a-col",{attrs:{span:6}},[t("a-form-item",{attrs:{label:"预计复学日期"}},[t("CompatDatePicker",{staticStyle:{width:"100%"},model:{value:a.suspend.resumeDate,callback:function(e){a.$set(a.suspend,"resumeDate",e)},expression:"suspend.resumeDate"}})],1)],1)],1),t("a-form-item",{attrs:{"wrapper-col":{span:16,offset:6}}},[t("a-space",[t("a-button",{attrs:{type:"primary"},on:{click:a.applySuspend}},[a._v("登记休学")]),t("a-button",{on:{click:a.applyResume}},[a._v("复学")]),t("a-button",{on:{click:a.loadSuspendList}},[a._v("加载列表")])],1)],1)],1),t("a-table",{attrs:{"data-source":a.suspendList,columns:a.suspendColumns,rowKey:"id",pagination:!1}})],1),t("a-card",{attrs:{bordered:"",title:"退学与退费核算"}},[t("a-form",{attrs:{"label-col":{span:6},"wrapper-col":{span:16}}},[t("a-row",{attrs:{gutter:16}},[t("a-col",{attrs:{span:6}},[t("a-form-item",{attrs:{label:"学员ID"}},[t("a-input-number",{staticStyle:{width:"100%"},attrs:{min:1},model:{value:a.withdraw.studentId,callback:function(e){a.$set(a.withdraw,"studentId",e)},expression:"withdraw.studentId"}})],1)],1),t("a-col",{attrs:{span:6}},[t("a-form-item",{attrs:{label:"原因"}},[t("a-input",{model:{value:a.withdraw.reason,callback:function(e){a.$set(a.withdraw,"reason",e)},expression:"withdraw.reason"}})],1)],1)],1),t("a-form-item",{attrs:{"wrapper-col":{span:16,offset:6}}},[t("a-space",[t("a-button",{attrs:{type:"primary"},on:{click:a.applyWithdraw}},[a._v("发起退学")]),t("a-button",{on:{click:a.loadWithdrawList}},[a._v("加载列表")])],1)],1)],1),t("a-table",{attrs:{"data-source":a.withdrawList,columns:a.withdrawColumns,rowKey:"id",pagination:!1}})],1)],1)},d=[],l=r(o,i,d,!1,null,"d874f307",null,null);const u=l.exports;export{u as default};
