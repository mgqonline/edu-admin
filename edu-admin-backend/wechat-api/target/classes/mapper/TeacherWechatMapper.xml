<?xml version="1.0" encoding="UTF-8" ?>
<!DOCTYPE mapper PUBLIC "-//mybatis.org//DTD Mapper 3.0//EN" "http://mybatis.org/dtd/mybatis-3-mapper.dtd">
<mapper namespace="com.eduadmin.wechat.mapper.TeacherWechatMapper">
  <resultMap id="TeacherWechatBindingMap" type="com.eduadmin.wechat.domain.TeacherWechatBinding">
    <id column="id" property="id" />
    <result column="teacher_id" property="teacherId" />
    <result column="openid" property="openid" />
    <result column="unionid" property="unionid" />
    <result column="created_at" property="createdAt" />
  </resultMap>

  <select id="findTeacherIdByOpenid" parameterType="string" resultType="long">
    SELECT teacher_id FROM teacher_wechat_binding WHERE openid = #{openid} LIMIT 1
  </select>

  <insert id="insertBinding" parameterType="com.eduadmin.wechat.domain.TeacherWechatBinding" useGeneratedKeys="true" keyProperty="id">
    INSERT INTO teacher_wechat_binding(teacher_id, openid, unionid, created_at)
    VALUES(#{teacherId}, #{openid}, #{unionid}, NOW())
  </insert>
</mapper>