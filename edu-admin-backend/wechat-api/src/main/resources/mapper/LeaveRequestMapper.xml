<?xml version="1.0" encoding="UTF-8" ?>
<!DOCTYPE mapper PUBLIC "-//mybatis.org//DTD Mapper 3.0//EN" "http://mybatis.org/dtd/mybatis-3-mapper.dtd">
<mapper namespace="com.eduadmin.wechat.mapper.LeaveRequestMapper">
    <resultMap id="LeaveRequestMap" type="com.eduadmin.wechat.domain.LeaveRequest">
        <id property="id" column="id"/>
        <result property="studentId" column="student_id"/>
        <result property="reason" column="reason"/>
        <result property="start" column="start_time"/>
        <result property="end" column="end_time"/>
        <result property="status" column="status"/>
        <result property="createdAt" column="created_at"/>
    </resultMap>

    <insert id="insert" parameterType="com.eduadmin.wechat.domain.LeaveRequest" useGeneratedKeys="true" keyProperty="id">
        INSERT INTO student_leave (student_id, reason, start_time, end_time, status, created_at)
        VALUES (#{studentId}, #{reason}, #{start}, #{end}, #{status}, NOW())
    </insert>

    <select id="listByStudentId" parameterType="long" resultMap="LeaveRequestMap">
        SELECT id, student_id, reason, start_time, end_time, status, created_at
        FROM student_leave
        WHERE student_id = #{studentId}
        ORDER BY id DESC
    </select>
</mapper>